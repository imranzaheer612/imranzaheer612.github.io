<!DOCTYPE html>
<html lang="en-us">
    <head>
        
        <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="description" content="Website Description">
<title>
Buld Own 64 Bit Os - Build OS
</title>



        
        <meta property="og:title" content="Buld own 64-bit OS - Build OS" />
<meta property="og:type" content="website" />
<meta property="og:description" content="Website Description"/>
<meta property="og:url" content="https://imranzaheer612.github.io/blog/buildos/"/>
<meta property="og:site_name" content="Build OS"/>




<meta property="og:image" content="https://imranzaheer612.github.io/home/gumbal.jpg"/>

<meta property="og:image" content="https://imranzaheer612.github.io/home/profile.jpg"/>




        
<link rel="shortcut icon" href="/img/fav.ico">


        





<link rel="stylesheet" href="/css/main.min.34e2ad88ae997b30ff043e352a8f04c158c77ef1fc2e8cb7229e296ef69b9a4f.css" integrity="sha256-NOKtiK6ZezD/BD41Ko8EwVjHfvH8Loy3Ip4pbvabmk8=" crossorigin="anonymous" media="screen">





        
        
        
        
    </head>
    <body>
        <section id="top" class="section">
            
            <div class="container hero  fade-in one ">
                

<h1 class="bold-title is-1">Blog</h1>


            </div>
            
            <div class="section  fade-in two ">
                
<div class="container">
    <hr>
    <nav class="navbar" role="navigation" aria-label="main navigation">
        
        <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false" >
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
          <span aria-hidden="true"></span>
        </a>
        <div class="navbar-menu " id="navMenu">
            
            
            
            
            <a class="navbar-item" href="/">main</a>
            

            
            

            
                
            

            
                
            

            
            
            
            <a class="navbar-item" href="/#lorem"></a>
            
            
            
            
            
            
            
            <a class="navbar-item" href="/#about">Meet Me Imran</a>
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://imranzaheer612.github.io/projects/">
                  
                  
                  Hobbies
                  
                  
                  </a>
                
                
            
            
            
            
            
                
                
                
                
                  <a class="navbar-item" href="https://imranzaheer612.github.io/blog/">
                  
                  Back to Blog
                  
                  </a>
                
                
            
            
            
            

            
            
            <a class="navbar-item" href="/#contact">Contact</a>
            
            

            

            
            
        </div>
    </nav>
    <hr>
</div>



                
<div class="container">
    <h2 class="title is-1 top-pad strong-post-title">
        <a href="https://imranzaheer612.github.io/blog/buildos/">Buld own 64-bit OS</a>
    </h2>
    <div class="post-data">
        Apr 17, 2021 |
        4 minutes read
    </div>
    
    <div class="blog-share">
        Share this:
        
        <a class="twitter-share-button" href="https://twitter.com/intent/tweet?text=Buld%20own%2064-bit%20OS%20https%3a%2f%2fimranzaheer612.github.io%2fblog%2fbuildos%2f" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
            <i class="fab fa-twitter"></i>
            <span class="hidden">Twitter</span>
        </a>
        
        
        <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fimranzaheer612.github.io%2fblog%2fbuildos%2f" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
            <i class="fab fa-facebook-f"></i>
            <span class="hidden">Facebook</span>
        </a>
        
        
        <a class="icon-pinterest" href="http://pinterest.com/pin/create/button/?url=https%3a%2f%2fimranzaheer612.github.io%2fblog%2fbuildos%2f&amp;description=Buld%20own%2064-bit%20OS" onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
            <i class="fab fa-pinterest-p"></i>
            <span class="hidden">Pinterest</span>
        </a>
        
    </div>
    
    
      
    
      
    
      
    
      
    
      
    
      
      
     <p>
         Series: 
          
           <a href="/series/quickstart">
             quickstart</a>
         
        </p>
      
    
      
      
     <p>
         Tags: 
          
           <a href="/tags/os-operating-systems">
             OS, Operating Systems</a>
         
        </p>
      
    
      
    
</div>

<div class="container markdown top-pad">
    <p>This blog was actually an assignment given by our cow professor <a href="https://pk.linkedin.com/in/imran-abeel-6a517846">Dr Muhammad Imran Abeel</a>.</p>

<h1 id="build-your-own-64-bit-operating-system" class="anchor-link"><a href="#build-your-own-64-bit-operating-system">Build Your Own 64-bit Operating System</a></h1>
<p>Today i will show you how you can build your own 64-bit Operating System. But before the start of this tutorial you should have some basic knowldge of computer programming laguages. You should have the knowldge about the assembly language.</p>
<br>
<p>Here you can find the repo for the code <a href="https://github.com/imranzaheer612/Building-64-bit-Kernal">https://github.com/imranzaheer612/Building-64-bit-Kernal.</a></p>

<h2 id="setting-up-the-enviroment" class="anchor-link"><a href="#setting-up-the-enviroment">Setting up the enviroment</a></h2>

<h3 id="text-editor" class="anchor-link"><a href="#text-editor">Text Editor</a></h3>
<p>You should have any text editor for writting and editting the code. For this tutorial i am using the vs Code. You can download it from the there <a href="https://code.visualstudio.com/download">website</a>.</p>
<p><img src="/blog/vscodepic.png" alt="vscode"></p>

<h3 id="docker" class="anchor-link"><a href="#docker">Docker</a></h3>
<p>Install <a href="https://docs.docker.com/docker-for-windows/install/">docker</a> from the website. But you shlould have WSL 2 backend. As mentioned in there prequisites tab.</p>
<p><img src="/blog/docker.png" alt="docker"></p>

<h4 id="setting-up-wsl-2" class="anchor-link"><a href="#setting-up-wsl-2">Setting up WSL 2</a></h4>
<p>Follow the following steps or can refer to this <a href="https://www.windowscentral.com/how-install-wsl2-windows-10">page</a>.</p>
<ul>
<li>

<h5 id="enable-windows-subsystem-for-linux" class="anchor-link"><a href="#enable-windows-subsystem-for-linux">Enable Windows Subsystem for linux</a></h5>
</li>
</ul>
<p>Open the power shell as admin and run this command</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">dism.exe <span style="">/</span>online <span style="">/</span>enable<span style="">-</span>feature <span style="">/</span>featurename<span style="">:</span>Microsoft<span style="">-</span>Windows<span style="">-</span>Subsystem<span style="">-</span>Linux <span style="">/</span>all <span style="">/</span>norestart
</code></pre></div><ul>
<li>

<h5 id="enable-virtual-machine" class="anchor-link"><a href="#enable-virtual-machine">Enable Virtual Machine</a></h5>
</li>
</ul>
<p>Open the power shell as admin and run this command</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">dism.exe <span style="">/</span>online <span style="">/</span>enable<span style="">-</span>feature <span style="">/</span>featurename<span style="">:</span>VirtualMachinePlatform <span style="">/</span>all <span style="">/</span>norestart
</code></pre></div><ul>
<li>

<h5 id="install-wsl-2-update" class="anchor-link"><a href="#install-wsl-2-update">Install WSL 2 Update</a></h5>
</li>
</ul>
<p>The next part takes only a couple of steps.</p>
<p>Download the WSL2 Kernel update.<br>
Run the installer.<br>
When prompted for elevated permissions, click yes.</p>
<p>Once the installer has done its thing, you&rsquo;ll now have WSL2 successfully installed on your PC.</p>

<h3 id="qemu" class="anchor-link"><a href="#qemu">Qemu</a></h3>
<p>Qemu is actually a virtual machine. You can download it from <a href="https://www.qemu.org/download/#windows">here</a>. In order to setup the qemu enviroment you can consider this <a href="https://dev.to/whaleshark271/using-qemu-on-windows-10-home-edition-4062">link</a>. You can skip the last step (installing ubuntu on qemu because we will make aour own OS ðŸ˜ƒ).</p>
<p><img src="/blog/qemu.jpg" alt="qemu"></p>

<h2 id="building-os" class="anchor-link"><a href="#building-os">Building OS.</a></h2>
<p>You will learn how to make a simple 32-bit OS using docker, vscode and qemu. I have attached an detailed vedio from <a href="https://www.youtube.com/channel/UCUVahoidFA7F3Asfvamrm7w">youtube channel</a>. You can consider the attached vedios for detailed explanation.</p>
<p>Building a simpple 32-bit OS.<br>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/FkrpUaGThTQ" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
</p>
<p>Converting it to 64-bit OS using the Protected Mode Addressing.<br>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/wz9CZBeXR6U" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>
</p>

<h3 id="imp-building-commands" class="anchor-link"><a href="#imp-building-commands">Imp Building Commands</a></h3>
<p>In this first vedio we will setup the Docker enviroment by making and docker image using the command</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">  docker build buildenv <span style="">-</span>t myos<span style="">-</span>buildenv
</code></pre></div><br>
<br>
<p>You will also required some of the basic build commands as used in the vedio.</p>
<p>Enter build environment:</p>
<ul>
<li>Linux or MacOS:</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">docker run <span style="">--</span>rm <span style="">-</span>it <span style="">-</span>v <span style="color:#4070a0">&#34;$pwd&#34;</span><span style="">:/</span>root<span style="">/</span>env myos<span style="">-</span>buildenv
</code></pre></div><br>
<ul>
<li>Windows (CMD):</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">docker run <span style="">--</span>rm <span style="">-</span>it <span style="">-</span>v <span style="color:#4070a0">&#34;%cd%&#34;</span><span style="">:/</span>root<span style="">/</span>env myos<span style="">-</span>buildenv
</code></pre></div><br>
<ul>
<li>Windows (PowerShell):</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">docker run <span style="">--</span>rm <span style="">-</span>it <span style="">-</span>v <span style="color:#4070a0">&#34;${pwd}:/root/env&#34;</span> myos<span style="">-</span>buildenv
</code></pre></div><br>
* NOTE: If you are having trouble with an unshared drive, ensure your docker daemon has access to the drive you're development environment is in. For Docker Desktop, this is in "Settings > Shared Drives" or "Settings > Resources > File Sharing".
Build for x86 (other architectures may come in the future):
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">make build<span style="">-</span>x86_64
</code></pre></div><p>To leave the build environment, enter &ldquo;exit&rdquo;.</p>

<h4 id="emulate" class="anchor-link"><a href="#emulate">Emulate</a></h4>
<p>After building the basic OS you can emulate the operating system using Qemu: (Don&rsquo;t forget to add qemu to your path!)</p>
<ul>
<li>Use the follwing command to emulate the OS.</li>
</ul>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">qemu<span style="">-</span>system<span style="">-</span>x86_64 <span style="">-</span>cdrom dist<span style="">/</span>x86_64<span style="">/</span>kernel.iso
</code></pre></div><br>
<ul>
<li>NOTE: When building your operating system, if changes to your code fail to compile, ensure your QEMU emulator has been closed, as this will block writing to kernel.iso.</li>
</ul>
<p>Alternatively, you should be able to load the operating system on a USB drive and boot into it when you turn on your computer. (I haven&rsquo;t actually tested this yet.)</p>

<h3 id="build-32-bit-os" class="anchor-link"><a href="#build-32-bit-os">Build 32-bit OS</a></h3>
<p>We will make the 32-bit OS based on the concept of the <strong>Real Mode Addressing</strong>. So thats why it will be easier to implement and later we can extend it to a 64-bit OS.</p>
<p><img src="/blog/realMode.png" alt="Real Mode Addressing"></p>
<p>We will make a simple print Funtion in c that will print some text on to the screen. So, this will be just an intro about building a basic 32-bit OS. In the next section we will discuss how to convert it to 64-bit OS using the idea of protected mode addressing.</p>
<br>

<h3 id="converting-to-64-bit" class="anchor-link"><a href="#converting-to-64-bit">Converting to 64-bit</a></h3>
<p>As you can see we successfully build our 3-bit OS in the above section. Now we are ready to change it to a 64-bit OS. The 64-bit will be diff from the 32-bit one this is because we have used the <strong>Real Mode Addressong</strong>. Now we will use the <strong>Protected Mode Addressing</strong>. As you know we don&rsquo;t use the physical address of the memory in case of the protected mode but we uses the concept of <strong>Virtual Memory</strong>. We have to build the</p>
<ul>
<li>Discriptor Tables</li>
<li>Gloabl Discriptor Tables</li>
<li>Page Tables</li>
</ul>
<p><img src="/blog/protectedMode.png" alt="Protect Mode Addressing"></p>
<p>We will be using the multi level pagging. You can know more about the multi level paging <a href="https://www.geeksforgeeks.org/multilevel-paging-in-operating-system/">multi level pagin</a>.</p>
<p><img src="/blog/multilevelpaging.png" alt="Protect Mode Addressing"></p>
<p>We will also use the C code to make some print funtion to print strings and chars to the screeen.</p>

<h2 id="output" class="anchor-link"><a href="#output">Output</a></h2>
<p>We will use the <strong>Qemu</strong> to emulate our 64-bit OS. As we run our <strong>kernal.iso</strong> file through the qemu we will see the output strings we printed using the C code.</p>
<p><img src="/blog/os.png" alt="My 64-bit OS"></p>
<br>
You can see i printed NUST log using the print_str() funtion we built using C.  And here you go you have created your own 64-bit Kernel! Sounds cool aha?  
<br>
<br>
<p>Are you curious how i printed this styled text?ðŸ¤” You can make your own using this <a href="https://www.text-image.com/convert/">image converter</a>.</p>
<br>
<br>
<p><strong>Hope it will be helpful for you</strong>.</p>

</div>





                
                <div class="container">
    <hr>
</div>
<div class="container has-text-centered top-pad">
    <a href="#top">
        <i class="fa fa-arrow-up"></i>
    </a>
</div>

<div class="container">
    <hr>
</div>

                <div class="section" id="footer">
    <div class="container has-text-centered">
    
        <span class="footer-text">
            <a href="https://github.com/victoriadrake/hugo-theme-introduction/"><strong>Introduction</strong></a> theme for <a href="http://gohugo.io/">Hugo</a>. Made with <a href="https://victoria.dev"><i class="fa fa-heart"></i> and <i class="fa fa-coffee"></i></a> by open source contributors.
        </span>
    
    </div>
</div>

                
            </div>
        </section>
        
        


<script src="https://imranzaheer612.github.io/js/bundle.f6c977229f84ae8df89c8647befcf3a170b8157f180a3f0afa4620b19a336994.js" integrity="sha256-9sl3Ip&#43;Ero34nIZHvvzzoXC4FX8YCj8K&#43;kYgsZozaZQ="></script>






        
        
        
        
    </body>
</html>
